<!DOCTYPE html>
<meta charset="utf-8">

<head>
<meta name="robots" content="noindex">

<title>BLIP</title>


<!-- Bootstrap core CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.0/css/all.css">

<!-- <link href="https://fonts.googleapis.com/css?family=Playfair&#43;Display:700,900&amp;display=swap" rel="stylesheet"> -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&display=swap" rel="stylesheet"> 
<link href="../style.css" rel="stylesheet">
</head>

<body>

  <header class="blog-header pb-3 pt-3">
    <div class="row flex-nowrap justify-content-between align-items-center">
      <div class="col-3 pt-1">
        <!-- <a class="link-secondary" href="#">Subscribe</a> -->
      </div>
      <div class="col-6 text-center">
          <div class="row justify-content-center">
              <div class="col-3 align-self-center">
                  <a href="/"><img src="../blip.png" class="img-fluid"></a>
              </div>
          </div>
      </div>
      <div class="col-3 d-flex align-items-center">
      </div>
    </div>
  </header>

      <div class="container-fluid mt-3">
        <div class="row">
          <div class="col-9 px-4">

            <div class="row">
              <div class="col-12">
                <div class="card mb-5 shadow-sm bg-light">
                  <div class="card-body d-flex flex-column">
                    <div class="row">
                      <div class="col-3 d-flex">
                        <div class="row ">
                          <div class="col-10">
                            <!-- <img src="../images/sectors/Virtual Reality.png" class="img-fluid" style="height:30px; display: inline-block;"> -->
                            <h5 id="domainlabel"></h5>
                          </div>
                          <div class="col-2">
                            <a href="../" id="sector-sm" class="btn btn-outline-dark btn-light noblebtn"><i class="fas fa-home"></i>
                            </a>
                          </div>
                            <!-- <div class="col-4">
                                <span id="sector-sm" class="btn btn-outline-secondary btn-light noblebtn"><img src="../images/sectors/Social Media.png" class="img-fluid" style="height:30px">
                                </span>
                            </div>
                            <div class="col-4">
                                <span id="sector-vr" class="btn btn-outline-secondary btn-light noblebtn"><img src="../images/sectors/Virtual Reality.png" class="img-fluid" style="height:30px">
                                </span>
                            </div>
                            <div class="col-4">
                                <span id="sector-va" class="btn btn-outline-secondary btn-light noblebtn"><img src="../images/sectors/Voice Assistants.png" class="img-fluid" style="height:30px">
                                </span>
                            </div> -->
                        </div>
                      </div>
                      <div class="col-9 align-self-end">
                        <div class="row">
                          <div class="col-6">
                            <input id="search" type="text" class="form-control" placeholder="Search terms (≥2 chars)" aria-label="Search terms (≥3 chars)" aria-describedby="basic-addon1">
                          </div>
                          <div class="col-4 justify-content-end">
                            <div class="input-group mb-3">
                              <label class="input-group-text" for="aspectinput">Aspect</label>
                              <select class="form-select" id="aspectinput"><option value="All" selected=""></option><option value="undefined">undefined</option></select>
                            </div>
                          </div>
                          <div class="col-2 justify-content-end">
                            <button id="shuffle-btn" class="btn btn-light btn-block"><i class="fas fa-sync-alt"></i> Shuffle</button>
                          </div>
                        </div>
                    </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
        <div id="allcards" class="row h-scroll" data-masonry='{"percentPosition": true}'>
            <!-- <div class="col-lg-2 col-sm-3 mb-4">
              <div class="card">
                <svg class="bd-placeholder-img card-img-top" width="100%" height="200" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: Image cap" preserveAspectRatio="xMidYMid slice" focusable="false"><title>Placeholder</title><rect width="100%" height="100%" fill="#868e96"/><text x="50%" y="50%" fill="#dee2e6" dy=".3em">Image cap</text></svg>
        
                <div class="card-body">
                  <h5 class="card-title">Card title that wraps to a new line</h5>
                  <p class="card-text">This is a longer card with supporting text below as a natural lead-in to additional content. This content is a little bit longer.</p>
                </div>
              </div>
            </div>
            <div class="col-lg-2 col-sm-3 mb-4">
              <div class="card p-3">
                <figure class="p-3 mb-0">
                  <blockquote class="blockquote">
                    <p>A well-known quote, contained in a blockquote element.</p>
                  </blockquote>
                  <figcaption class="blockquote-footer mb-0 text-muted">
                    Someone famous in <cite title="Source Title">Source Title</cite>
                  </figcaption>
                </figure>
              </div>
            </div>
            <div class="col-lg-2 col-sm-3 mb-4">
              <div class="card">
                <svg class="bd-placeholder-img card-img-top" width="100%" height="200" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: Image cap" preserveAspectRatio="xMidYMid slice" focusable="false"><title>Placeholder</title><rect width="100%" height="100%" fill="#868e96"/><text x="50%" y="50%" fill="#dee2e6" dy=".3em">Image cap</text></svg>
        
                <div class="card-body">
                  <h5 class="card-title">Card title</h5>
                  <p class="card-text">This card has supporting text below as a natural lead-in to additional content.</p>
                  <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
                </div>
              </div>
            </div>
            <div class="col-lg-2 col-sm-3 mb-4">
              <div class="card bg-primary text-white text-center p-3">
                <figure class="mb-0">
                  <blockquote class="blockquote">
                    <p>A well-known quote, contained in a blockquote element.</p>
                  </blockquote>
                  <figcaption class="blockquote-footer mb-0 text-white">
                    Someone famous in <cite title="Source Title">Source Title</cite>
                  </figcaption>
                </figure>
              </div>
            </div>
            <div class="col-lg-2 col-sm-3 mb-4">
              <div class="card text-center">
                <div class="card-body">
                  <h5 class="card-title">Card title</h5>
                  <p class="card-text">This card has a regular title and short paragraph of text below it.</p>
                  <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
                </div>
              </div>
            </div>
            <div class="col-lg-2 col-sm-3 mb-4">
              <div class="card">
                <svg class="bd-placeholder-img card-img" width="100%" height="260" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: Card image" preserveAspectRatio="xMidYMid slice" focusable="false"><title>Placeholder</title><rect width="100%" height="100%" fill="#868e96"/><text x="50%" y="50%" fill="#dee2e6" dy=".3em">Card image</text></svg>
        
              </div>
            </div>
            <div class="col-lg-2 col-sm-3 mb-4">
              <div class="card p-3 text-end">
                <figure class="mb-0">
                  <blockquote class="blockquote">
                    <p>A well-known quote, contained in a blockquote element.</p>
                  </blockquote>
                  <figcaption class="blockquote-footer mb-0 text-muted">
                    Someone famous in <cite title="Source Title">Source Title</cite>
                  </figcaption>
                </figure>
              </div>
            </div>
            <div class="col-lg-2 col-sm-3 mb-4">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title">Card title</h5>
                  <p class="card-text">This is another card with title and supporting text below. This card has some additional content to make it slightly taller overall.</p>
                  <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
                </div>
              </div>
            </div>
            <div class="col-lg-2 col-sm-3 mb-4">
                <div class="card">
                  <div class="card-body">
                    <h5 class="card-title">Card title</h5>
                    <p class="card-text">This is another card with title and supporting text below. This card has some additional content to make it slightly taller overall.</p>
                    <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
                  </div>
                </div>
              </div> -->
          </div>
        </div>
        <div class="col-3 px-4">
          <div class="card mb-5 shadow-sm bg-light">
            <div class="card-body d-flex flex-column">
              <div class="row">
                <div class="col-12">
                  <h1>&nbsp;</h1>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <!-- <div class="col-6">
            </div> -->
            <div class="col-12">
              <div class="row">
                <div class="col-12">
                  <div class="progress my-3" style="height:20px">
                    <div id="accepted-bar" class="progress-bar progress-bar-striped bg-danger progress-bar-animated" role="progressbar" style="width: 50%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"></div>
                    <div id="rejected-bar" class="progress-bar progress-bar-striped bg-warning progress-bar-animated" role="progressbar" style="width: 50%" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
                  </div>
                </div>
              </div>
              <div class="accordion" id="accordionExample">
                
                <div class="accordion-item">
                  <h2 class="accordion-header" id="headingTwo">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                      <span style="color: #c62828">
                        <i class="fas fa-bookmark"></i>
                      </span> &nbsp; Bookmarked Articles &nbsp; <span id="accepted-count" class="badge rounded-pill bg-dark">0</span>
                    </button>
                  </h2>
                  <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                    <div id="accepted-block" class="accordion-body">
                      <strong>This is the second item's accordion body.</strong> It is hidden by default, until the collapse plugin adds the appropriate classes that we use to style each element. These classes control the overall appearance, as well as the showing and hiding via CSS transitions. You can modify any of this with custom CSS or overriding our default variables. It's also worth noting that just about any HTML can go within the <code>.accordion-body</code>, though the transition does limit overflow.
                    </div>
                  </div>
                </div>
                <div class="accordion-item">
                  <h2 class="accordion-header" id="headingThree">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                      <span style="color: #ff9800">
                        <i class="fas fa-times-circle"></i>
                      </span> &nbsp; Removed from my view &nbsp; <span id="rejected-count" class="badge rounded-pill bg-dark">0</span>
                    </button>
                  </h2>
                  <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
                    <div id="rejected-block" class="accordion-body">
                      <strong>This is the third item's accordion body.</strong> It is hidden by default, until the collapse plugin adds the appropriate classes that we use to style each element. These classes control the overall appearance, as well as the showing and hiding via CSS transitions. You can modify any of this with custom CSS or overriding our default variables. It's also worth noting that just about any HTML can go within the <code>.accordion-body</code>, though the transition does limit overflow.
                    </div>
                  </div>
                </div>
              </div>
          </div>
        </div>
      </div>
      </div>

</body>

<style>
    .accept-btn:hover {
      color: #000;
    }

    path {
        cursor: pointer;
    }
    div.tooltip {   
        position: absolute;         
        text-align: center;         
        /* width: 80px;                    
        height: 28px;                    */
        padding: 12px;               
        font: 14px sans-serif;      
        background-color: "#fff"; 
        border-width: 1px;
        border-color: #555;    
        border-radius: 8px;
        font-weight: 700;        
        pointer-events: none;           
    }

    #cardhead::first-letter {
    text-transform:capitalize;
}
    #paper-abstract {
        /* overflow-y: scroll; */
    }
    .highlight {
        background-color: #fffacd;
    }

    .uccards {
      cursor: default;
    }

    .uccards:hover {
      border: solid #555 1px;
    }

    .accepted-card {
      font-size: 0.8rem;
    }

    /* body, html {
      margin: 0;
      padding: 0;
      overflow: hidden;
    }

    .h-scroll {
        height: 90vh;
        overflow-y: scroll;
    } */


</style>
<!-- JavaScript Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
<!-- Load d3.js -->
<script src="https://d3js.org/d3.v4.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha384-GNFwBvfVxBkLMJpYMOABq3c+d3KnQxudP/mGPkzpZSTYykLBNsZEnG2D9G/X/+7D" crossorigin="anonymous" async></script>
<script>

  // $(document).ready(() => {
  //   loadcards(false);
  // })
// var data = []
// var accepted = []
// var rejected = []
// var aspectDic = new Map();
// var currentData = '';

var data = []
var maindata = []
var accepted = []
var rejected = []


// $( document ).ready(function() {
//     console.log( "ready!" );
// });

var getUrlParameter = function getUrlParameter(sParam) {
    var sPageURL = window.location.search.substring(1),
        sURLVariables = sPageURL.split('&'),
        sParameterName,
        i;

    for (i = 0; i < sURLVariables.length; i++) {
        sParameterName = sURLVariables[i].split('=');

        if (sParameterName[0] === sParam) {
            return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
        }
    }
    return false;
};
var tech = getUrlParameter('tech');
console.log(tech)
if (tech == 'sm') {
  file = '../dataset/new_sm_summs1.csv'
  $('#domainlabel').text('Social Media')
    $.when(
      d3.csv(file, function(dt) {
          maindata = dt;
          data = dt;
      })
  ).then(function() {
      loadcards(false)
      }
  )
}
if (tech == 'va') {
  file = '../dataset/new_va_summs1.csv'
  $('#domainlabel').text('Voice Assistants')
    $.when(
      d3.csv(file, function(dt) {
          maindata = dt;
          data = dt;
      })
  ).then(function() {
      loadcards(false)
      }
  )
}
if (tech == 'vr') {
  file = '../dataset/new_vr_summs1.csv'
  $('#domainlabel').text('Virtual Reality')
    $.when(
      d3.csv(file, function(dt) {
          maindata = dt;
          data = dt;
      })
  ).then(function() {
      loadcards(false)
      }
  )
}




var aspect_colors = {
  "Economy" : "rgba(102, 194, 165, 0.4)",
  "Equality & Justice" : "rgba(252, 141, 98, 0.4)",
  "Health & Wellbeing" : "rgba(141, 160, 203, 0.4)",
  "Information, Discourse & Governance" : "rgba(231, 138, 195, 0.4)",
  "Politics" : "rgba(166, 216, 84, 0.4)",
  "Power" : "rgba(255, 217, 47, 0.4)",
  "Security & Privacy" : "rgba(229, 196, 148, 0.4)",
  "Social Norms & Relationships" : "rgba(179, 179, 179, 0.4)",
  "User Experience & Entertainment" : "rgba(76, 175, 80, 0.4)"
}

var card_colors = {
  "Economy" : "rgba(102, 194, 165, 0.05)",
  "Equality & Justice" : "rgba(252, 141, 98, 0.05)",
  "Health & Wellbeing" : "rgba(141, 160, 203, 0.05)",
  "Information, Discourse & Governance" : "rgba(231, 138, 195, 0.05)",
  "Politics" : "rgba(166, 216, 84, 0.05)",
  "Power" : "rgba(255, 217, 47, 0.05)",
  "Security & Privacy" : "rgba(229, 196, 148, 0.05)",
  "Social Norms & Relationships" : "rgba(179, 179, 179, 0.05)",
  "User Experience & Entertainment" : "rgba(76, 175, 80, 0.05)"
}

$('#aspectinput').html('<option value="All" selected>All</option>')
$.each(aspect_colors, function(index, value) {
    $('#aspectinput').append($("<option />").val(index).text(index));
});

function loadcards(shuffle=true) {

var term=''

if (shuffle) {
    data = d3.shuffle(data);
    newLst = [];
    constraintSet = [];
    for(let i = 0; i < data.length; i++) {
      if(constraintSet.includes(data[i].label)) {
        newLst.push(data[i]);
      } else {
        newLst.unshift(data[i]);
        constraintSet.push(data[i].label);
      }
    }
    data = newLst;
}

datalen = data.length
accelen = accepted.length
rejelen = rejected.length



$("#accepted-bar").css('width', accelen / datalen * 100 + '%')
$("#rejected-bar").css('width', rejelen / datalen * 100 + '%')
$("#accepted-count").text(accelen)
$("#rejected-count").text(rejelen)

$("#allcards").html('')
$('#accepted-block').html('')
$('#rejected-block').html('')
$.when(
    data.forEach(function(d) {
        if (accepted.includes(d.index)) {
          accepted_color = '#ffcdd2'
          like_color = '#c62828'
          $('#accepted-block').append(`
            <div class="card shadow-sm mb-2 p-0 accepted-card">
              <div class="card-body">
                ` + d.title + `
              </div>  
            </div>
          `)         
        } else {
          accepted_color = '#f5f5f5'
          like_color = '#999'
        }
        if (rejected.includes(d.index)) {
          $('#rejected-block').append(`
            <div class="card shadow-sm mb-2 p-0 accepted-card">
              <div class="card-body">
                ` + d.title + `
              </div>  
            </div>
          `)
        } else {
          // headercolor = aspect_colors[d.label].replace(0.3, 0.5)
          $("#allcards").append(`
                <div id="card-` + d.index + `" class="col-3 mb-3" >
                  
                    <div class="card shadow uccards" style="background-color:` + card_colors[d.label] + `">
                    <div id="cardhead" class="card-header" style="background-color:` + aspect_colors[d.label] + `">
                      <div>
                        ` + d.label + `
                      </div>
                    </div>
                        <div class="card-body">
                        
                        <p class="card-text">` + d.gpt_summary + `</p>
                        <a style="text-decoration:none;" href="` + d.url + `" target="_blank"><h6 class="card-title">` + d.title + `</h6></a>
                        <div class="d-flex justify-content-between">
                          <div>
                              <button id="accept-` + d.index + `" onClick="accept_option(this.id)" class="btn btn-sm accept-btn" style="color: ` + like_color + `">
                                  <i class="fas fa-bookmark"></i>
                              </button>
                              <button id="reject-` + d.index + `" onClick="reject_option(this.id)" class="btn btn-sm reject-btn" style="color: #ff9800">
                                  <i class="fas fa-times-circle"></i>
                              </button>
                          </div>
                          <div>
                            <img src="../images/logos/` + d.magazine + `.png" height="15">
                            
                          </div>
                            
                        </div>
                            </div>
                    </div>
                    </div>
                `)
            
        }
        
})
).then(function() {    
    var msnry = new Masonry('#allcards');
    msnry.layout();
}); 
}

var wto;

function onChange(timeout) {
      clearTimeout(wto);
      wto = setTimeout(function() {
          var text = $("#search").val()
          var aspect = $("#aspectinput").val()
          var texbool = true
          var aspbool = true
          var newdata = []

          console.log(aspect)
          
          maindata.forEach(function(d) {
              if (aspect != "All") {
                  aspbool = d.label.toLowerCase().includes(aspect.toLowerCase())
              }
              if (text.length >= 3) {
                  texbool = d.text.toLowerCase().includes(text.toLowerCase())
              }
              if (aspbool && texbool) {
                newdata.push(d)
              }
          });

          data = newdata
          loadcards(false);
          }, timeout); 
  }
  

  $("#search").on('input', function(e){
      onChange(500);
  });

  $("#aspectinput").on('input', function(e){
      onChange(0);
  });

  // $("#clearsel").on('click', function(){
  //     // $("#sectorinput").val('All')
  //     $("#aspectinput").val('All')
  //     $("#search").val('')
  //     data.forEach(function(d) {d.search = true})
  //     $("#articletotal").html(data.length)
  //     changeOpacity(data)
  // })
$('#shuffle-btn').on('click', function(e) {
    loadcards();
})

function accept_option(elem) {
    elemid = elem.split('-')[1]
    if (accepted.includes(elemid)) {
      accepted = accepted.filter(x => x !== elemid);
    } else {
      accepted.push(elemid)
    }
    console.log(accepted)
    loadcards(false)
}

function reject_option(elem) {
    elemid = elem.split('-')[1]
    rejected.push(elemid)
    if (accepted.includes(elemid)) {
      accepted = accepted.filter(x => x !== elemid);
    }
    console.log(rejected)
    $("#card-" + elemid).css('z-index', 100)
    $("#card-" + elemid).animate({opacity: '0', left: 3000, top: 500}, 500, function() {
        loadcards(false)
    });
}

</script>

</html>